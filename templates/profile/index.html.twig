{% extends 'base_back.html.twig' %}

{% block title %}Profile - BioSync{% endblock %}

{% block body %}
        <div class="page-header">
            <h1 class="page-title">Mon Profil</h1>
            <p class="page-subtitle">Gerez vos informations personnelles et votre profil sante.</p>
        </div>

        <div class="grid grid-cols-2 gap-6">
            {# Informations personnelles #}
            <div class="card">
                <div class="card-header flex-between">
                    <h4 class="card-title">Informations personnelles</h4>
                    <a href="{{ path('app_profile_edit') }}" class="btn btn-sm btn-ghost">Modifier</a>
                </div>
                <div class="mb-4">
                    <div class="sidebar-user" style="background: var(--background);">
                        <div class="sidebar-user-avatar" style="width: 64px; height: 64px; font-size: 1.5rem;">
                            {{ user.initials }}
                        </div>
                        <div>
                            <div class="sidebar-user-name" style="font-size: 1.25rem;">{{ user.nomComplet }}</div>
                            <div class="sidebar-user-role">Membre depuis {{ user.dateInscription|date('d/m/Y') }}</div>
                        </div>
                    </div>
                </div>
                <div class="list-item">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--gray-500)" stroke-width="2">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                        <polyline points="22,6 12,13 2,6"/>
                    </svg>
                    <div class="list-item-content">
                        <div class="list-item-subtitle">Email</div>
                        <div class="list-item-title">{{ user.email }}</div>
                    </div>
                </div>
                <div class="list-item">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--gray-500)" stroke-width="2">
                        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                    </svg>
                    <div class="list-item-content">
                        <div class="list-item-subtitle">Score global</div>
                        <div class="list-item-title">{{ user.scoreGlobal }} points</div>
                    </div>
                </div>
            </div>

            {# Profil Sante #}
            <div class="card">
                <div class="card-header flex-between">
                    <h4 class="card-title">Profil Sante</h4>
                    <a href="{{ path('app_profile_health') }}" class="btn btn-sm btn-ghost">
                        {{ user.profilSante ? 'Modifier' : 'Configurer' }}
                    </a>
                </div>
                {% if user.profilSante %}
                    <div class="list-item">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--primary)" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                            <line x1="16" y1="2" x2="16" y2="6"/>
                            <line x1="8" y1="2" x2="8" y2="6"/>
                            <line x1="3" y1="10" x2="21" y2="10"/>
                        </svg>
                        <div class="list-item-content">
                            <div class="list-item-subtitle">Age</div>
                            <div class="list-item-title">{{ user.profilSante.age }} ans</div>
                        </div>
                    </div>
                    <div class="list-item">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--secondary)" stroke-width="2">
                            <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
                        </svg>
                        <div class="list-item-content">
                            <div class="list-item-subtitle">Poids</div>
                            <div class="list-item-title">{{ user.profilSante.poids }} kg</div>
                        </div>
                    </div>
                    <div class="list-item">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--warning)" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <polyline points="12 6 12 12 16 14"/>
                        </svg>
                        <div class="list-item-content">
                            <div class="list-item-subtitle">Heure de reveil</div>
                            <div class="list-item-title">{{ user.profilSante.heureReveil|date('H:i') }}</div>
                        </div>
                    </div>
                {% else %}
                    <div class="empty-state">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="var(--gray-300)" stroke-width="2">
                            <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
                        </svg>
                        <p class="text-gray mt-4">Completez votre profil sante pour un suivi personnalise</p>
                        <a href="{{ path('app_profile_health') }}" class="btn btn-primary mt-4">Configurer maintenant</a>
                    </div>
                {% endif %}
            </div>
        </div>

        {# Statistiques #}
        <div class="card mt-6">
            <div class="card-header">
                <h4 class="card-title">Mes statistiques</h4>
            </div>
            <div class="grid grid-cols-4 gap-4">
                <div class="stat-card">
                    <div class="stat-card-value">{{ user.repas|length }}</div>
                    <div class="stat-card-label">Repas enregistres</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-value">{{ user.seancesSport|length }}</div>
                    <div class="stat-card-label">Seances de sport</div>
                </div>
                <div class="stat-card">
                        <div class="stat-card-value">
                            {% if 'ROLE_SPECIALISTE' in user.roles %}
                                {{ user.rendezVousSpecialiste|length }}
                            {% else %}
                                {{ user.rendezVousPatient|length }}
                            {% endif %}
                        </div>
                        <div class="stat-card-label">Rendez-vous</div>
                    </div>

            </div>
        </div>
{% endblock %}
