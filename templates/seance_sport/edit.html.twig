{% extends 'base_back.html.twig' %}

{% block title %}Admin - Modifier Séance{% endblock %}

{% block body %}
<div class="page-header flex-between">
    <div>
        <h1 class="page-title">Modifier la Séance</h1>
        <p class="page-subtitle">{{ seance_sport.nomSeance }}</p>
    </div>
    <a href="{{ path('app_seance_sport_index') }}" class="btn btn-secondary">← Retour</a>
</div>

<div class="card" style="max-width:700px;">
    <div class="card-header">
        <h4 class="card-title">Informations de la séance</h4>
    </div>
    <div style="padding:20px;">
        {{ form_start(form, {'attr': {'novalidate': 'novalidate', 'id': 'seanceForm'}}) }}

        <div class="form-group">
            {{ form_label(form.nomSeance, 'Nom de la séance') }}
            {{ form_widget(form.nomSeance, {'attr': {'class': 'form-control'}}) }}
            {{ form_errors(form.nomSeance) }}
        </div>

        <div style="display:flex; gap:15px;">
            <div class="form-group" style="flex:1;">
                {{ form_label(form.dateSeance, 'Date') }}
                {{ form_widget(form.dateSeance, {'attr': {'class': 'form-control'}}) }}
                {{ form_errors(form.dateSeance) }}
            </div>
            <div class="form-group" style="flex:1;">
                {{ form_label(form.heureDebut, 'Heure de début') }}
                {{ form_widget(form.heureDebut, {'attr': {'class': 'form-control'}}) }}
                {{ form_errors(form.heureDebut) }}
            </div>
        </div>

        <div style="display:flex; gap:15px;">
            <div class="form-group" style="flex:1;">
                {{ form_label(form.dureeMinutes, 'Durée (minutes)') }}
                {{ form_widget(form.dureeMinutes, {'attr': {'class': 'form-control', 'min': '5', 'step': '5'}}) }}
                {{ form_errors(form.dureeMinutes) }}
            </div>
            <div class="form-group" style="flex:1;">
                {{ form_label(form.medailleObtenue, 'Médaille') }}
                {{ form_widget(form.medailleObtenue, {'attr': {'class': 'form-control'}}) }}
                {{ form_errors(form.medailleObtenue) }}
            </div>
        </div>

        <div style="margin-top:20px;">
            <button type="submit" class="btn btn-secondary">Enregistrer</button>
            <a href="{{ path('app_seance_sport_index') }}" class="btn" style="margin-left:10px;">Annuler</a>
        </div>

        {{ form_end(form) }}
    </div>
</div>

<script>
document.getElementById('seanceForm').addEventListener('submit', function(e) {
    let valid = true;
    const nom = document.querySelector('[name*="nomSeance"]');
    if (nom && nom.value.trim().length < 3) { alert('Le nom doit contenir au moins 3 caractères'); valid = false; }
    const duree = document.querySelector('[name*="dureeMinutes"]');
    if (duree && (parseInt(duree.value) <= 0 || parseInt(duree.value) % 5 !== 0)) { alert('La durée doit être positive et divisible par 5'); valid = false; }
    if (!valid) e.preventDefault();
});
</script>
{% endblock %}
